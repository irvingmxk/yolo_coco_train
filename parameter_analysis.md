# YOLO 推理参数分析

## 当前配置

```python
conf = 0.5    # 置信度阈值
iou = 0.45    # IOU阈值
```

## 参数分析

### 1. 置信度阈值 (conf = 0.5)

**优点：**
- ✅ 减少误检，提高精确率
- ✅ 适合对精确度要求高的生产环境
- ✅ 符合 `bubble_ocr.py` 中的建议值

**缺点：**
- ❌ 可能漏掉置信度在 0.4-0.5 之间的气泡
- ❌ 对于部分遮挡或模糊的气泡可能检测不到
- ❌ 如果模型训练不够充分，可能召回率偏低

### 2. IOU阈值 (iou = 0.45)

**优点：**
- ✅ 保留更多检测框
- ✅ 适合气泡可能重叠的情况

**缺点：**
- ❌ 可能导致重复检测（同一个气泡多个框）
- ❌ 气泡通常不重叠，可以适当提高以减少重复

## 优化建议

### 方案1: 平衡型（推荐用于大多数场景）

```python
conf = 0.35-0.4
iou = 0.5
```

**理由：**
- 平衡精确率和召回率
- `conf=0.35-0.4` 可以检测到更多气泡，减少漏检
- `iou=0.5` 更好地去除重复检测

### 方案2: 高召回率（优先检测到所有气泡）

```python
conf = 0.25-0.3
iou = 0.5-0.6
```

**理由：**
- 不错过任何气泡
- 后续可以通过其他方式过滤误检
- 适合对召回率要求高的场景

### 方案3: 高精确率（当前配置，适合生产环境）

```python
conf = 0.5
iou = 0.5-0.55  # 建议提高
```

**理由：**
- 减少误检和重复检测
- 适合对精确度要求高的场景
- **建议将 iou 提高到 0.5-0.55**，因为气泡通常不重叠

## 针对气泡检测任务的建议

根据气泡检测的特点：
1. **气泡通常比较清晰**：不像小目标检测那么困难
2. **气泡通常不重叠**：但可能很接近
3. **需要平衡精确率和召回率**：既要检测到所有气泡，又要避免误检

### 推荐配置

```python
conf = 0.35-0.4  # 从 0.5 降低，提高召回率
iou = 0.5        # 从 0.45 提高，减少重复检测
```

### 如果保持高精确率

```python
conf = 0.5       # 保持不变
iou = 0.5-0.55   # 从 0.45 提高，减少重复检测
```

## 测试建议

1. 使用验证集图片测试不同参数组合
2. 观察指标：
   - 检测到的气泡数量
   - 是否有明显漏检（召回率）
   - 是否有重复检测（同一个气泡多个框）
   - 是否有误检（精确率）
3. 根据实际效果调整参数

## 参数调整指南

### 如果漏检较多（召回率低）
- 降低 `conf`（如 0.5 → 0.35-0.4）

### 如果误检较多（精确率低）
- 提高 `conf`（如 0.4 → 0.5）

### 如果有重复检测
- 提高 `iou`（如 0.45 → 0.5-0.55）

### 如果独立气泡被过滤
- 降低 `iou`（如 0.5 → 0.45）

